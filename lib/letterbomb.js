!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("letterbomb",[],e):"object"==typeof exports?exports.letterbomb=e():t.letterbomb=e()}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const s=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([01](?:\.\d+)*)\s*\)/,a=/#([0-9a-f]{1,2})([0-9a-f]{1,2})([0-9a-f]{1,2})/,n=/(\d+\.\d+|\d+)([a-z]+)?/,l=t=>{switch(t[0]){case"#":return(t=>{try{let[e,i,s,r]=a.exec(t);return[...[i,s,r].map(t=>parseInt(t,16)*(1===t.length?17:1)),1]}catch(t){return console.log(t),!1}})(t);case"r":return("a"===t[3]?t=>{try{let[e,i,s,a,n]=r.exec(t);return[i,s,a,n].filter(t=>t).map(t=>parseInt(t))}catch(t){return console.log(t),!1}}:t=>{try{let[e,i,r,a]=s.exec(t);return[...[i,r,a].map(t=>parseInt(t)),1]}catch(t){return console.log(t),!1}})(t);default:return(t=>{let[e,i,s]=n.exec(t);return[parseInt(i),s||""]})(t)}},o=(t,e,i)=>t+(e-t)*i,h=(t,e,i)=>{let s=i*(t.length-1),r=Math.min(Math.floor(s),t.length-1),a=Math.min(r+1,t.length-1);return e(t[r],t[a],s%1)},c=t=>{let e=t.map(t=>l(t));if(2===e[0].length){let t=e[0][1],i=e.map(t=>t[0]);return e=>((t,e)=>`${t}${e}`)(h(i,o,e),t)}{let t=(t=>t[0].map((e,i)=>t.map(t=>t[i])))(e);return e=>(([t,e,i,s])=>`rgba(${t}, ${e}, ${i}, ${s})`)(t.map(t=>h(t,o,e)))}},p=(t,e)=>{let i,s,r=[];do{if(i=e.exec(t)){let t=i.index;t>s+1&&r.push([s+1,t-1]);let e=i.index+i[0].length;r.push([i.index,e]),s=e}}while(i);return r},d={velocity:{x:0,y:0},acceleration:{x:0,y:0},heading:0,ttl:1e3,text:".",grid:!1,style:{},onCreate:()=>{},onUpdate:()=>{}};class u{constructor(t){Object.assign(this,{...d,...t}),this.elapsed=0,this.frameNumber=0,this.updateTransform=this.grid?this.updateGridTransform:this.updateTransform,this.element.style.opacity=1,this.setText(this.text),this.buildStyles(this.style),this.nextStyles=this.getStyleSnapshot(),this.onCreate(this),Object.assign(this.element.style,this.nextStyles)}get alive(){return this.elapsed<this.ttl}get lifeFrac(){return this.elapsed/this.ttl}buildStyles(t){let e={},i={};Object.keys(t).map(s=>{let r=t[s];Array.isArray(r)?1===r.length?e[s]=r:i[s]=c(r):"object"==typeof r||(e[s]=r)}),this.dynamicStyles=i,this.fixedStyles=e}setText(t){this.element.innerText=t}getStyleSnapshot(){let t=this.lifeFrac,e=Object.keys(this.dynamicStyles).reduce((e,i)=>{let s=this.dynamicStyles[i];return{...e,[i]:s(t)}},{...this.fixedStyles});return{...e,transform:this.getScaledTransform(e)}}getScaledTransform(t){let{scaleX:e,scaleY:i,scale:s}=t;return s=s||1,e=e||s,i=i||s,this.getTransform(e,i)}getTransform(t,e){return`translate3d(${this.position.x}px, ${this.position.y}px, 0) rotateZ(${this.heading}rad) scale(${t}, ${e})`}getGridTransform(t,e){return`translate3d(${this.position.x-this.position.x%this.grid}px, ${this.position.y-this.position.y%this.grid}px, 0) rotateZ(${this.heading}rad) scale(${this.scale.x}, ${this.scale.y})`}update(t){this.elapsed+=1e3*t,this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.nextStyles=this.getStyleSnapshot(),this.onUpdate(this),Object.assign(this.element.style,this.nextStyles),this.frameNumber++}}const m={emitEvery:500,position:{x:0,y:0},velocity:{x:0,y:0},acceleration:{x:0,y:0},onCreate:()=>{},onUpdate:()=>{},particleOptions:{position:{x:0,y:0},...d},MAX_EMIT_PER_STEP:10};class y{constructor(t){Object.assign(this,{...m,...t}),this.manager=t.manager,this.totalElapsed=0,this.elapsed=this.emitEvery,this.emitted=0,this.onCreate(this)}get alive(){return!(this.maxEmissions&&this.emitted>=this.maxEmissions)&&!(this.ttl&&this.totalElapsed>=this.ttl)}update(t){if(this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.elapsed+=1e3*t,this.totalElapsed+=1e3*t,this.elapsed>this.emitEvery){let t=Math.floor(this.elapsed/this.emitEvery);t=Math.min(t,this.MAX_EMIT_PER_STEP),this.maxEmissions&&(t=Math.min(this.maxEmissions-this.emitted,t)),this.elapsed=0;for(let e=0;e<t;e++){this.emitted++;let t=this.particleOptions.position||{x:0,y:0},e={x:this.position.x+t.x,y:this.position.y+t.y};this.manager.addParticle({...this.particleOptions,position:e})}}this.onUpdate(this)}}i.d(e,"default",function(){return x});const f={max:100,preallocate:10,tagName:"span",autoStart:!0};class x{constructor(t){Object.assign(this,{...f,...t}),this._pool=[],this.particles=[],this.emitters=[],this.foldElement=document.createElement("div"),this.foldElement.className="text-particle-manager-reservoir",Object.assign(this.foldElement.style,{width:0,height:0,position:"absolute",top:0,left:0}),this.allocate(this.preallocate),document.body.appendChild(this.foldElement),this.out=document.querySelector("p"),this.frameStart=null}start(){this.raf=requestAnimationFrame(t=>this.update(t))}update(t){this.frameStart||(this.frameStart=t);let e=t-this.frameStart;this.frameStart=t;let i=e/1e3;this.particles=this.particles.filter(t=>(t.update(i),!!t.alive||(t.element.style.opacity=0,this.push(t.element),!1))),this.out.innerText=this.particles.length,this.emitters=this.emitters.filter(t=>(t.update(i),t.alive)),0===this.emitters.length&&0===this.particles.length?(cancelAnimationFrame(this.raf),this.raf=!1):requestAnimationFrame(t=>this.update(t))}addParticle(t){if(this.particles.length<this.max){let e=this.particles.push(new u({...t,element:this.pop()}));return!this.raf&&this.autoStart&&this.start(),e}}addEmitter(t){let e=this.emitters.push(new y({...t,manager:this}));return!this.raf&&this.autoStart&&this.start(),e}from(t,e,i){p(t.innerText,e)}push(t){this._pool.push(t)}pop(t){return this._pool.length>0?this._pool.pop():this.create()}create(){let t=document.createElement(this.tagName);return Object.assign(t.style,{display:"block",position:"absolute",pointerEvents:"none",transform:"translate3d(0,0,0)",opacity:0}),this.foldElement.appendChild(t),t}allocate(t){if(this._pool.length<t)for(let e=this._pool.length;e<t;e++)this.push(this.create())}}}])});