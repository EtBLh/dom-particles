!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("domTextParticles",[],e):"object"==typeof exports?exports.domTextParticles=e():t.domTextParticles=e()}(window,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var i={};s.r(i),s.d(i,"rgbToNumbers",function(){return l}),s.d(i,"rgbaToNumbers",function(){return h}),s.d(i,"hexToNumbers",function(){return c}),s.d(i,"valueToNumberAndUnit",function(){return p}),s.d(i,"tryGetValue",function(){return u}),s.d(i,"colourToCSSString",function(){return d}),s.d(i,"valueToCSSString",function(){return m}),s.d(i,"lerp",function(){return y}),s.d(i,"easeArray",function(){return f}),s.d(i,"transpose",function(){return x}),s.d(i,"propValueToFunction",function(){return g});const r=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,n=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([01](?:\.\d+)*)\s*\)/,a=/#([0-9a-f]{1,2})([0-9a-f]{1,2})([0-9a-f]{1,2})/,o=/(\d+\.\d+|\d+)([a-z]+)?/,l=t=>{try{let[e,s,i,n]=r.exec(t);return[...[s,i,n].map(t=>parseInt(t)),1]}catch(e){return console.warn(`Invalid RGB value: ${t}`),!1}},h=t=>{try{let[e,s,i,r,a]=n.exec(t);return[...[s,i,r].map(t=>parseInt(t)),parseFloat(a)]}catch(e){return console.warn(`Invalid RGBA value: ${t}`),!1}},c=t=>{try{let[e,s,i,r]=a.exec(t);return[...[s,i,r].map(t=>parseInt(t,16)*(1===t.length?17:1)),1]}catch(e){return console.warn(`Invalid hex value: ${t}`),!1}},p=t=>{try{let[e,s,i]=o.exec(t);return[parseFloat(s),i||""]}catch(e){return console.warn(`Invalid CSS unit string: ${t}`),!1}},u=t=>{switch(t[0]){case"#":return c(t);case"r":return("a"===t[3]?h:l)(t);default:return p(t)}},d=([t,e,s,i])=>`rgba(${t}, ${e}, ${s}, ${i})`,m=(t,e)=>`${t}${e}`,y=(t,e,s)=>t+(e-t)*s,f=(t,e,s)=>{let i=s*(t.length-1),r=Math.min(Math.floor(i),t.length-1),n=Math.min(r+1,t.length-1);return e(t[r],t[n],i%1)},x=t=>t[0].map((e,s)=>t.map(t=>t[s])),g=t=>{let e=t.map(t=>u(t));if(2===e[0].length){let t=e[0][1],s=e.map(t=>t[0]);return e=>m(f(s,y,e),t)}{let t=x(e);return e=>d(t.map(t=>f(t,y,e)))}},v={ttl:1e3,contents:".",style:{display:"inline-block",zIndex:1},onCreate:()=>{},onUpdate:()=>{},onDestroy:()=>{},heading:!1,grid:!1};class _{constructor(t){Object.assign(this,{...v,...t,velocity:{...{x:0,y:0},...t.velocity},position:{...{x:0,y:0},...t.position},acceleration:{...{x:0,y:0},...t.acceleration},style:{...v.style,...t.style}}),this.elapsed=0,this.frameNumber=0,this.getTransform=this.grid?this.getGridTransform:this.getTransform,this.setContents(this.contents),this.updateStyle(this.style),this.nextProps=this.getSnapshot(),this.onCreate(this),Object.assign(this.element.style,this.nextProps)}get alive(){return!this.ttl||this.elapsed<this.ttl}get lifeFrac(){return this.elapsed/this.ttl}buildProps(t){let e={},s={};Object.keys(t).map(i=>{let r=t[i];Array.isArray(r)?1===r.length?e[i]=r:s[i]=g(r):"object"==typeof styleValue||(e[i]=r)}),this.dynamicProps={...this.dynamicProps,...s},this.fixedProps={...this.fixedProps,...e}}setContents(t){this.element.innerHTML=t}setText(t){this.element.innerText=t}setStyleText(t){this.element.style.cssText=t}updateStyle(t){this.style={...this.style,...t},this.buildProps(t)}getSnapshot(){let t=Object.keys(this.dynamicProps).reduce((t,e)=>({...t,[e]:this.dynamicProps[e](this.lifeFrac)}),{...this.fixedProps});return{...t,transform:this.getScaledTransform(t)}}getScaledTransform(t){let{rotation:e,scale:s,scaleX:i,scaleY:r,skew:n,skewX:a,skewY:o}=t;return e=this.heading&&`${this.heading}rad`||e||0,s=s||1,i=i||s,r=r||s,n=n||0,a=a||n,o=o||n,this.getTransform(i,r,e,a,o)}getTransform(t,e,s,i,r){return`translate3d(${this.position.x}px, ${this.position.y}px, 0px) rotateZ(${s}) scale(${t}, ${e}) skew(${i}, ${r})`}getGridTransform(t,e,s,i,r){return`translate3d(${this.position.x-this.position.x%this.grid}px, ${this.position.y-this.position.y%this.grid}px, 0px) rotateZ(${s}) scale(${t}, ${e}) skew(${i}, ${r})`}update(t){this.elapsed+=1e3*t,this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.nextProps=this.getSnapshot(),this.onUpdate(this,t),Object.assign(this.element.style,this.nextProps),this.frameNumber++}}const b={maxEmissions:!1,ttl:!1,emitEvery:500,heading:0,particleOptions:{...v},onCreate:()=>{},onUpdate:()=>{},onDestroy:()=>{},MAX_EMIT_PER_STEP:16};class S{constructor(t){t=t||{},Object.assign(this,{...b,...t,position:{...{x:0,y:0},...t.position},velocity:{...{x:0,y:0},...t.velocity},acceleration:{...{x:0,y:0},...t.acceleration}}),this.manager=t.manager,this.elapsed=0,this.emitted=0,this.frameNumber=0,this.onCreate(this)}get alive(){return!(this.maxEmissions&&this.emitted>=this.maxEmissions)&&!(this.ttl&&this.totalElapsed>=this.ttl)}update(t){if(this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.elapsed+=1e3*t,this.totalElapsed+=1e3*t,this.elapsed>=this.emitEvery){let t=Math.floor(this.elapsed/this.emitEvery);t=Math.min(t,this.MAX_EMIT_PER_STEP),this.maxEmissions&&(t=Math.min(this.maxEmissions-this.emitted,t)),this.elapsed=0;for(let e=0;e<t;e++){let t={...{x:0,y:0},...this.particleOptions.position},e={x:this.position.x+t.x,y:this.position.y+t.y},s={...{x:0,y:0},...this.particleOptions.velocity},i=Math.atan2(s.y,s.x),r=Math.sqrt(s.x*s.x+s.y*s.y),n={x:r*Math.cos(i+this.heading),y:r*Math.sin(i+this.heading)};this.manager.addParticle({...this.particleOptions,position:e,velocity:n}),this.emitted++}this.frameNumber++}this.onUpdate(this,t)}}const T={max:100,preallocate:10,tagName:"span",autostart:!0};class P{constructor(t){Object.assign(this,{...T,...t}),this.container=this.container||document.querySelector("body"),this.container.style.position="relative",this._pool=[],this._particles=[],this._emitters=[],this.foldElement=document.createElement("div"),this.foldElement.className="text-particle-manager-reservoir",this.foldElement.style.cssText="position: absolute; width: 0; height: 0; top: 0; left: 0",this.reservoirCSS="position: absolute; display: none; pointer-events: none; white-space: pre-wrap; transform: translate3d(0px, 0px, 0px); box-sizing: border-box;",this._allocate(this.preallocate),this.container.appendChild(this.foldElement),this.frameStart=null}addParticle(t){if(this._particles.length<this.max){let e=new _({...t,element:this._pop()});return this._particles.push(e),!this.raf&&this.autostart&&this.start(),e}}addEmitter(t){let e=new S({...t,manager:this});return this._emitters.push(e),!this.raf&&this.autostart&&this.start(),e}start(){this.frameStart=performance.now(),this.raf=requestAnimationFrame(()=>this._update(this.frameStart))}reset(){this.raf&&cancelAnimationFrame(this.raf),this._particles.map(t=>{t.setContents(""),t.setStyleText(this.reservoirCSS),this._push(t.element)}),this._particles=[],this._emitters.map(t=>t.onDestroy(t)),this._emitters=[]}clearEmitters(){this._emitters.map(t=>t.onDestroy(t)),this._emitters=[]}_update(t){let e=t-this.frameStart;this.frameStart=t;let s=e/1e3,i=[];this._particles=this._particles.filter(t=>(t.update(s),t.alive||i.push(t),t.alive)),i.map(t=>{t.onDestroy(t),t.setContents(""),t.setStyleText(this.reservoirCSS),this._push(t.element)});let r=[];this._emitters=this._emitters.filter(t=>(t.update(s),t.alive||r.push(t),t.alive)),r.map(t=>t.onDestroy(t)),0===this._emitters.length&&0===this._particles.length?(cancelAnimationFrame(this.raf),this.raf=!1):requestAnimationFrame(t=>this._update(t))}_push(t){this._pool.push(t)}_pop(t){return this._pool.length>0?this._pool.pop():this._create()}_create(){let t=document.createElement(this.tagName);return t.style.cssText=this.reservoirCSS,this.foldElement.appendChild(t),t}_allocate(t){if(this._pool.length<t)for(let e=this._pool.length;e<t;e++)this._push(this._create())}}P.utilities=i;e.default=P}]).default});